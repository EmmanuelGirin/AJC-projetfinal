---
#create secret and service
apiVersion: v1
kind: Secret
type: Opaque
metadata:
 name: pgadmin
 namespace: icgroup
data:
 pgadmin-password: U3VwZXJTZWNyZXQ=

---
#Create Config Map
apiVersion: v1
kind: ConfigMap
metadata:
 name: pgadmin-config
 namespace: icgroup
data:
 servers.json: |
   {
       "Servers": {
         "1": {
           "Name": "PostgreSQL DB",
           "Group": "Servers",
           "Port": 5432,
           "Username": "odoo",
           "Host": "odoo-postgres",
           "SSLMode": "prefer",
           "MaintenanceDB": "postgres"
         }
       }
   }
---
#Create service to connnect to db
---
apiVersion: v1
kind: Service
metadata:
  name: pgadmin-postgres
  namespace: icgroup
  labels:
    app: pgadmin
    environment : production
spec:
  ports:
  - port: 5432
    targetPort: 5432
  selector:
    app: pgadmin
    tier: postgres

---
#Create service to connnect from webapp to odoo
---
apiVersion: v1
kind: Service
metadata:
  namespace: icgroup
  name: pgadmin
  labels:
    app: pgadmin
    environment : production
spec:
  ports:
  - port: 80
    protocol: TCP
    targetPort: 80
    nodePort: 31002
  selector:
    app: pgadmin
    tier: frontend
  type: NodePort